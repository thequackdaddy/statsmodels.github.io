{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.987\n",
      "Model:                            OLS   Adj. R-squared:                  0.986\n",
      "Method:                 Least Squares   F-statistic:                     1168.\n",
      "Date:                Tue, 17 Dec 2019   Prob (F-statistic):           2.13e-43\n",
      "Time:                        19:04:33   Log-Likelihood:                 5.5112\n",
      "No. Observations:                  50   AIC:                            -3.022\n",
      "Df Residuals:                      46   BIC:                             4.626\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          4.9755      0.077     64.608      0.000       4.820       5.131\n",
      "x1             0.4945      0.012     41.632      0.000       0.471       0.518\n",
      "x2             0.4394      0.047      9.410      0.000       0.345       0.533\n",
      "x3            -0.0183      0.001    -17.567      0.000      -0.020      -0.016\n",
      "==============================================================================\n",
      "Omnibus:                        1.826   Durbin-Watson:                   2.296\n",
      "Prob(Omnibus):                  0.401   Jarque-Bera (JB):                0.982\n",
      "Skew:                          -0.193   Prob(JB):                        0.612\n",
      "Kurtosis:                       3.567   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.51752976  4.96546348  5.37864108  5.73311767  6.01358992  6.21591042\n",
      "  6.34776901  6.42742944  6.48072862  6.53683174  6.62344047  6.76224169\n",
      "  6.96534438  7.23329014  7.55496422  7.90942165  8.26932842  8.60545238\n",
      "  8.89146602  9.10827199  9.24714074  9.31114477  9.31465382  9.28097396\n",
      "  9.23851847  9.21613964  9.23838837  9.32148058  9.47063296  9.67920586\n",
      "  9.92979421 10.19708708 10.45202623 10.66658028 10.81835017 10.89424929\n",
      " 10.89265358 10.8236683  10.70746785 10.5709811  10.4434671  10.35170785\n",
      " 10.31560816 10.3449253  10.43766591 10.58041353 10.75053286 10.91988867\n",
      " 11.05946839 11.14414872]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[11.14887517 11.03721187 10.82638896 10.55567182 10.27674747 10.0410698\n",
      "  9.88726191  9.83165975  9.86431257  9.95141921]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           4.975498\n",
       "x1                  0.494462\n",
       "np.sin(x1)          0.439363\n",
       "I((x1 - 5) ** 2)   -0.018319\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    11.148875\n",
       "1    11.037212\n",
       "2    10.826389\n",
       "3    10.555672\n",
       "4    10.276747\n",
       "5    10.041070\n",
       "6     9.887262\n",
       "7     9.831660\n",
       "8     9.864313\n",
       "9     9.951419\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
