{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.986\n",
      "Model:                            OLS   Adj. R-squared:                  0.985\n",
      "Method:                 Least Squares   F-statistic:                     1082.\n",
      "Date:                Mon, 16 Dec 2019   Prob (F-statistic):           1.20e-42\n",
      "Time:                        16:46:55   Log-Likelihood:                 3.3581\n",
      "No. Observations:                  50   AIC:                             1.284\n",
      "Df Residuals:                      46   BIC:                             8.932\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          4.8691      0.080     60.561      0.000       4.707       5.031\n",
      "x1             0.5228      0.012     42.159      0.000       0.498       0.548\n",
      "x2             0.4592      0.049      9.421      0.000       0.361       0.557\n",
      "x3            -0.0215      0.001    -19.760      0.000      -0.024      -0.019\n",
      "==============================================================================\n",
      "Omnibus:                        0.858   Durbin-Watson:                   2.135\n",
      "Prob(Omnibus):                  0.651   Jarque-Bera (JB):                0.937\n",
      "Skew:                           0.230   Prob(JB):                        0.626\n",
      "Kurtosis:                       2.511   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.33128593  4.81115554  5.25390981  5.63452166  5.93699615  6.15699842\n",
      "  6.30256587  6.39278763  6.45466831  6.51869119  6.61380989  6.76269141\n",
      "  6.97799199  7.26027771  7.59793149  7.96906177  8.3450992   8.69549052\n",
      "  8.99271837  9.2168223   9.35867825  9.42149757  9.42029942  9.37944319\n",
      "  9.32862626  9.29800487  9.31323949  9.39127889  9.53757553  9.74518968\n",
      "  9.99592968 10.26334068 10.51705118 10.72776295 10.87206462 10.93627815\n",
      " 10.91870607 10.82991036 10.69097716 10.53005237 10.37771738 10.2619646\n",
      " 10.20359839 10.21281701 10.28753701 10.41373557 10.56775442 10.72018679\n",
      " 10.8407089  10.90306202]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.87488859 10.72388209 10.46805137 10.14843635  9.81906002  9.53370169\n",
      "  9.33272997  9.23321913  9.22476869  9.27204987]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           4.869111\n",
       "x1                  0.522757\n",
       "np.sin(x1)          0.459220\n",
       "I((x1 - 5) ** 2)   -0.021513\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.874889\n",
       "1    10.723882\n",
       "2    10.468051\n",
       "3    10.148436\n",
       "4     9.819060\n",
       "5     9.533702\n",
       "6     9.332730\n",
       "7     9.233219\n",
       "8     9.224769\n",
       "9     9.272050\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
