{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.982\n",
      "Model:                            OLS   Adj. R-squared:                  0.981\n",
      "Method:                 Least Squares   F-statistic:                     850.3\n",
      "Date:                Mon, 16 Dec 2019   Prob (F-statistic):           2.81e-40\n",
      "Time:                        18:45:47   Log-Likelihood:                -1.3330\n",
      "No. Observations:                  50   AIC:                             10.67\n",
      "Df Residuals:                      46   BIC:                             18.31\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          4.9280      0.088     55.805      0.000       4.750       5.106\n",
      "x1             0.5133      0.014     37.688      0.000       0.486       0.541\n",
      "x2             0.5769      0.054     10.775      0.000       0.469       0.685\n",
      "x3            -0.0215      0.001    -17.981      0.000      -0.024      -0.019\n",
      "==============================================================================\n",
      "Omnibus:                        3.135   Durbin-Watson:                   2.015\n",
      "Prob(Omnibus):                  0.209   Jarque-Bera (JB):                2.922\n",
      "Skew:                           0.578   Prob(JB):                        0.232\n",
      "Kurtosis:                       2.746   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.39047068  4.9131434   5.39102989  5.79268926  6.09802746  6.30159872\n",
      "  6.4135002   6.45771314  6.46816274  6.4831444   6.53903185  6.66430107\n",
      "  6.87485179  7.17139515  7.53933693  7.95117527  8.37101922  8.76048545\n",
      "  9.0850046   9.31950084  9.45251183  9.48807192  9.44504932  9.35404611\n",
      "  9.25237039  9.1779067   9.16289165  9.22861757  9.38193425  9.61412349\n",
      "  9.90233152 10.2133238  10.50894535 10.75238951 10.91424517 10.97732895\n",
      " 10.93950835 10.81405212 10.62745027 10.41506181 10.21530536 10.0633471\n",
      "  9.98532307  9.99404504 10.08689566 10.24625841 10.44241195 10.63841332\n",
      " 10.79616748 10.88268625]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.85982936 10.68542276 10.38209053 10.00139013  9.61118927  9.2790496\n",
      "  9.05568521  8.96254607  8.98656633  9.0833633 ]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           4.928004\n",
       "x1                  0.513290\n",
       "np.sin(x1)          0.576906\n",
       "I((x1 - 5) ** 2)   -0.021501\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.859829\n",
       "1    10.685423\n",
       "2    10.382091\n",
       "3    10.001390\n",
       "4     9.611189\n",
       "5     9.279050\n",
       "6     9.055685\n",
       "7     8.962546\n",
       "8     8.986566\n",
       "9     9.083363\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
