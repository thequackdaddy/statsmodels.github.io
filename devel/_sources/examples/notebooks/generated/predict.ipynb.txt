{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.984\n",
      "Model:                            OLS   Adj. R-squared:                  0.982\n",
      "Method:                 Least Squares   F-statistic:                     917.9\n",
      "Date:                Sat, 07 Dec 2019   Prob (F-statistic):           4.97e-41\n",
      "Time:                        08:53:43   Log-Likelihood:               -0.26826\n",
      "No. Observations:                  50   AIC:                             8.537\n",
      "Df Residuals:                      46   BIC:                             16.18\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          4.8301      0.086     55.873      0.000       4.656       5.004\n",
      "x1             0.5185      0.013     38.890      0.000       0.492       0.545\n",
      "x2             0.4855      0.052      9.264      0.000       0.380       0.591\n",
      "x3            -0.0214      0.001    -18.282      0.000      -0.024      -0.019\n",
      "==============================================================================\n",
      "Omnibus:                        6.141   Durbin-Watson:                   2.200\n",
      "Prob(Omnibus):                  0.046   Jarque-Bera (JB):                6.461\n",
      "Skew:                          -0.423   Prob(JB):                       0.0395\n",
      "Kurtosis:                       4.544   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.29509664  4.78323199  5.23257371  5.61666082  5.91858197  6.13375393\n",
      "  6.27067457  6.34952677  6.39886231  6.45091101  6.53628537  6.67895108\n",
      "  6.8922895   7.17689914  7.52049736  7.89993831  8.28501578  8.64342598\n",
      "  8.94607496  9.17185866  9.31113025  9.36728507  9.35620282  9.3036385\n",
      "  9.24099102  9.20014439  9.20822928  9.28316553  9.430718    9.64354935\n",
      "  9.90242563 10.17937629 10.44228972 10.66018903 10.80832155 10.87222555\n",
      " 10.8501063  10.75313093 10.6035937  10.4312531  10.26844267 10.14475862\n",
      " 10.0821973  10.09154125 10.17058766 10.30451029 10.46829536 10.63085129\n",
      " 10.76011689 10.82832898]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.80195315 10.6463792  10.38064782 10.04815027  9.70600474  9.41107181\n",
      "  9.20603298  9.10894078  9.10879884  9.16825423]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           4.830105\n",
       "x1                  0.518502\n",
       "np.sin(x1)          0.485530\n",
       "I((x1 - 5) ** 2)   -0.021400\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.801953\n",
       "1    10.646379\n",
       "2    10.380648\n",
       "3    10.048150\n",
       "4     9.706005\n",
       "5     9.411072\n",
       "6     9.206033\n",
       "7     9.108941\n",
       "8     9.108799\n",
       "9     9.168254\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
