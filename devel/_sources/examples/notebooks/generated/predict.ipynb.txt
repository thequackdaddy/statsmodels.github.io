{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.983\n",
      "Model:                            OLS   Adj. R-squared:                  0.982\n",
      "Method:                 Least Squares   F-statistic:                     890.1\n",
      "Date:                Thu, 28 Nov 2019   Prob (F-statistic):           9.97e-41\n",
      "Time:                        12:25:09   Log-Likelihood:              -0.066723\n",
      "No. Observations:                  50   AIC:                             8.133\n",
      "Df Residuals:                      46   BIC:                             15.78\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.1070      0.086     59.314      0.000       4.934       5.280\n",
      "x1             0.4881      0.013     36.755      0.000       0.461       0.515\n",
      "x2             0.4692      0.052      8.988      0.000       0.364       0.574\n",
      "x3            -0.0185      0.001    -15.883      0.000      -0.021      -0.016\n",
      "==============================================================================\n",
      "Omnibus:                        3.590   Durbin-Watson:                   1.957\n",
      "Prob(Omnibus):                  0.166   Jarque-Bera (JB):                2.115\n",
      "Skew:                          -0.265   Prob(JB):                        0.347\n",
      "Kurtosis:                       2.143   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.64400106  5.10193563  5.52310344  5.88193481  6.16208804  6.35913427\n",
      "  6.48128516  6.5480437   6.58699998  6.62929815  6.70451958  6.8358227\n",
      "  7.03613812  7.3060442   7.63367202  7.99665538  8.36580553  8.70990682\n",
      "  9.00084529  9.21822774  9.3527323   9.40763994  9.39829545  9.34958632\n",
      "  9.29185381  9.25590794  9.26796551  9.34534277  9.49361037  9.70567814\n",
      "  9.96295999 10.23842755 10.50105083 10.7208964  10.87404534 10.94652306\n",
      " 10.93659527 10.85505295 10.7234394  10.57051074 10.42751136 10.32304057\n",
      " 10.27835378 10.30387034 10.39746164 10.54480085 10.72171675 10.89816504\n",
      " 11.0431645  11.12988711]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[11.13087115 11.00808965 10.77994191 10.48835762 10.18853099  9.9354073\n",
      "  9.77023038  9.71044465  9.74542417  9.8390742 ]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.106956\n",
       "x1                  0.488060\n",
       "np.sin(x1)          0.469176\n",
       "I((x1 - 5) ** 2)   -0.018518\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    11.130871\n",
       "1    11.008090\n",
       "2    10.779942\n",
       "3    10.488358\n",
       "4    10.188531\n",
       "5     9.935407\n",
       "6     9.770230\n",
       "7     9.710445\n",
       "8     9.745424\n",
       "9     9.839074\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
