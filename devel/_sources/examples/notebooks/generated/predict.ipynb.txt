{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.985\n",
      "Model:                            OLS   Adj. R-squared:                  0.984\n",
      "Method:                 Least Squares   F-statistic:                     985.3\n",
      "Date:                Tue, 10 Dec 2019   Prob (F-statistic):           1.00e-41\n",
      "Time:                        20:00:55   Log-Likelihood:                 3.3382\n",
      "No. Observations:                  50   AIC:                             1.324\n",
      "Df Residuals:                      46   BIC:                             8.972\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.0652      0.080     62.976      0.000       4.903       5.227\n",
      "x1             0.4829      0.012     38.927      0.000       0.458       0.508\n",
      "x2             0.4948      0.049     10.146      0.000       0.397       0.593\n",
      "x3            -0.0186      0.001    -17.064      0.000      -0.021      -0.016\n",
      "==============================================================================\n",
      "Omnibus:                        2.520   Durbin-Watson:                   2.356\n",
      "Prob(Omnibus):                  0.284   Jarque-Bera (JB):                2.024\n",
      "Skew:                          -0.493   Prob(JB):                        0.363\n",
      "Kurtosis:                       3.006   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.60063227  5.06686621  5.49464298  5.85699871  6.13670068  6.32907855\n",
      "  6.44279171  6.49840656  6.52501752  6.55546688  6.62094893  6.7458848\n",
      "  6.94391016  7.2156349   7.54854292  7.91904854  8.29637149  8.64759409\n",
      "  8.94306945  9.16129247  9.29243297  9.33995084  9.32002754  9.25890754\n",
      "  9.18858645  9.1415542   9.14545708  9.21855548  9.36672379  9.58248527\n",
      "  9.84624041 10.12948712 10.39950352 10.62472405 10.77992561 10.85037166\n",
      " 10.83423335 10.74289003 10.59905964 10.43306623 10.27785779 10.163593\n",
      " 10.11268621 10.1361249  10.23166438 10.38419665 10.56823258 10.7520897\n",
      " 10.90309753 10.99296527]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.99249161 10.86197575 10.62082021 10.31324088  9.99744143  9.73136303\n",
      "  9.55849832  9.49724288  9.53639138  9.63788103]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.065248\n",
       "x1                  0.482878\n",
       "np.sin(x1)          0.494758\n",
       "I((x1 - 5) ** 2)   -0.018585\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.992492\n",
       "1    10.861976\n",
       "2    10.620820\n",
       "3    10.313241\n",
       "4     9.997441\n",
       "5     9.731363\n",
       "6     9.558498\n",
       "7     9.497243\n",
       "8     9.536391\n",
       "9     9.637881\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
