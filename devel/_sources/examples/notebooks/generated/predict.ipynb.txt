{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.985\n",
      "Model:                            OLS   Adj. R-squared:                  0.984\n",
      "Method:                 Least Squares   F-statistic:                     983.6\n",
      "Date:                Thu, 12 Dec 2019   Prob (F-statistic):           1.04e-41\n",
      "Time:                        04:43:04   Log-Likelihood:                 2.2986\n",
      "No. Observations:                  50   AIC:                             3.403\n",
      "Df Residuals:                      46   BIC:                             11.05\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.0167      0.082     61.089      0.000       4.851       5.182\n",
      "x1             0.5066      0.013     39.998      0.000       0.481       0.532\n",
      "x2             0.5565      0.050     11.178      0.000       0.456       0.657\n",
      "x3            -0.0207      0.001    -18.579      0.000      -0.023      -0.018\n",
      "==============================================================================\n",
      "Omnibus:                        4.357   Durbin-Watson:                   2.229\n",
      "Prob(Omnibus):                  0.113   Jarque-Bera (JB):                1.983\n",
      "Skew:                           0.124   Prob(JB):                        0.371\n",
      "Kurtosis:                       2.056   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.50021567  5.00877342  5.4741529   5.86602273  6.16499796  6.36582496\n",
      "  6.47824461  6.52539187  6.53999478  6.55899732  6.61748967  6.74294293\n",
      "  6.95069573  7.24143413  7.60107891  8.00309873  8.41286916  8.79336139\n",
      "  9.11122594  9.34227188  9.47544137  9.51462639  9.4780293   9.39517229\n",
      "  9.30204692  9.2352008   9.22573299  9.29418444  9.4471632   9.67625874\n",
      "  9.95942376 10.26459652 10.55496848 10.79503184 10.95641337 11.02253606\n",
      " 10.99134265 10.87563368 10.70096435 10.5014459  10.31414121 10.1729755\n",
      " 10.10316249 10.11706187 10.21214863 10.37142791 10.56622721 10.76090722\n",
      " 10.91871723 11.00783317]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.99274199 10.83149037 10.54590402 10.185721    9.81641409  9.50316075\n",
      "  9.29488547  9.21228125  9.24274335  9.34345525]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.016716\n",
       "x1                  0.506576\n",
       "np.sin(x1)          0.556548\n",
       "I((x1 - 5) ** 2)   -0.020660\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.992742\n",
       "1    10.831490\n",
       "2    10.545904\n",
       "3    10.185721\n",
       "4     9.816414\n",
       "5     9.503161\n",
       "6     9.294885\n",
       "7     9.212281\n",
       "8     9.242743\n",
       "9     9.343455\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
