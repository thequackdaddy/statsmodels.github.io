{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.980\n",
      "Model:                            OLS   Adj. R-squared:                  0.979\n",
      "Method:                 Least Squares   F-statistic:                     762.2\n",
      "Date:                Fri, 06 Dec 2019   Prob (F-statistic):           3.31e-39\n",
      "Time:                        08:16:45   Log-Likelihood:                -2.2233\n",
      "No. Observations:                  50   AIC:                             12.45\n",
      "Df Residuals:                      46   BIC:                             20.09\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.1483      0.090     57.271      0.000       4.967       5.329\n",
      "x1             0.4894      0.014     35.298      0.000       0.461       0.517\n",
      "x2             0.4826      0.055      8.854      0.000       0.373       0.592\n",
      "x3            -0.0200      0.001    -16.465      0.000      -0.022      -0.018\n",
      "==============================================================================\n",
      "Omnibus:                        0.474   Durbin-Watson:                   2.159\n",
      "Prob(Omnibus):                  0.789   Jarque-Bera (JB):                0.625\n",
      "Skew:                           0.139   Prob(JB):                        0.732\n",
      "Kurtosis:                       2.529   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.64727007  5.11701713  5.54861735  5.91577205  6.20167359  6.40176685\n",
      "  6.5244976   6.58992491  6.62642548  6.66603142  6.73916751  6.86965244\n",
      "  7.0707855   7.34316155  7.67457325  8.04201672  8.41547101  8.76283046\n",
      "  9.05517955  9.27154365  9.40233511  9.45092844  9.43310594  9.37446466\n",
      "  9.30621094  9.26003321  9.26289578  9.33260857  9.47490108  9.68248098\n",
      "  9.93623228 10.20835597 10.46693739 10.68118965 10.82651188 10.88853104\n",
      " 10.86546342 10.76840765 10.61952125 10.44838023 10.28711978 10.16515462\n",
      " 10.10434618 10.11541088 10.19615941 10.33185647 10.49764169 10.66261417\n",
      " 10.79490937 10.86693438]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.84646085 10.69819515 10.44106119 10.11818411  9.78633178  9.50201605\n",
      "  9.30765665  9.22119538  9.23170333  9.30205664]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.148319\n",
       "x1                  0.489376\n",
       "np.sin(x1)          0.482553\n",
       "I((x1 - 5) ** 2)   -0.020042\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.846461\n",
       "1    10.698195\n",
       "2    10.441061\n",
       "3    10.118184\n",
       "4     9.786332\n",
       "5     9.502016\n",
       "6     9.307657\n",
       "7     9.221195\n",
       "8     9.231703\n",
       "9     9.302057\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
