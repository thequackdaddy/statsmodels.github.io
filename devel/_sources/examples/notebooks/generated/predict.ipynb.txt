{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.979\n",
      "Model:                            OLS   Adj. R-squared:                  0.978\n",
      "Method:                 Least Squares   F-statistic:                     721.9\n",
      "Date:                Sun, 15 Dec 2019   Prob (F-statistic):           1.12e-38\n",
      "Time:                        18:58:33   Log-Likelihood:                -4.1075\n",
      "No. Observations:                  50   AIC:                             16.21\n",
      "Df Residuals:                      46   BIC:                             23.86\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.0603      0.093     54.209      0.000       4.872       5.248\n",
      "x1             0.5042      0.014     35.021      0.000       0.475       0.533\n",
      "x2             0.4888      0.057      8.637      0.000       0.375       0.603\n",
      "x3            -0.0214      0.001    -16.961      0.000      -0.024      -0.019\n",
      "==============================================================================\n",
      "Omnibus:                        0.122   Durbin-Watson:                   2.135\n",
      "Prob(Omnibus):                  0.941   Jarque-Bera (JB):                0.265\n",
      "Skew:                           0.102   Prob(JB):                        0.876\n",
      "Kurtosis:                       2.707   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.5242736   5.00800354  5.45271488  5.83176944  6.12814264  6.33722055\n",
      "  6.46755799  6.53947291  6.58170833  6.62670982  6.70529489  6.84158967\n",
      "  7.04906514  7.32832382  7.66700081  8.04179528  8.42229879  8.77599124\n",
      "  9.07358387  9.29383131  9.42702214  9.47657445  9.45847424  9.39864899\n",
      "  9.32870782  9.28074824  9.28208258  9.35075067  9.49255596  9.70011199\n",
      "  9.95405602 10.22623022 10.48430795 10.69710494 10.83970276 10.89754286\n",
      " 10.86881848 10.76477153 10.60784554 10.42799827 10.25777974 10.12698434\n",
      " 10.0577557  10.06094855 10.13434534 10.26302055 10.42179292 10.57936268\n",
      " 10.70345398 10.76611773]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.73225647 10.56838419 10.29366905  9.95179287  9.60025628  9.29630058\n",
      "  9.08289306  8.97820712  8.97117277  9.02418697]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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P/jgg7pSpUq6f//+OiEhQWut9ZYtW3Tbtm3vuWb16tU6MDBQ16hRQz/88MP666+/zvU4Z8+erfv27au11vqrr77Sc+bMSffc06dP6wULFtz+evfu3bpfv34WicMWXjOLiIvTN30f1H9TRY8ZEW/taHJHWJjWH36odenSWoPWTk5au7trXbCg1t7eWrdrp/XmzVqbTNaONOdefllrV1et//7b2pFYHBCizeVncwfvOcload+ZwEOBMimflwFCM/M4tpjATSaTrlu3rp41a5bWWuukpCTdq1cv/d5772mtzSfwW7du6TJlyuhz585prbWOj4/Xf2fzP01SUlKmz70zgd9Pen94LMHar5mlJI38SGvQ3Uut17Gx1o4ml5lMWicnWzuK3HXxotaFC2vdurVj/EG6Q3oJPLudmKW01hdSWvAXAJ/0TlRK9VZKhSilQiIiIrL5dLln8+bNeHh48PLLLwPg7OzMpEmTmDVrFrGxsWaviYmJISkpieIpkwfc3d2pWvXenvSRI0fSo0cPWrRoQeXKlW/P0Ny6dSvNmzfn+eefJyAgAID58+dTr149AgMDef3110lONiZyzJ49mypVqtC0aVO2b99+12NPnDgRMJa+bdmyJTVr1qR27dr8888/DBkyhD/++IPAwEAmTZrE1q1badeuHQBXr16lQ4cO1KhRg/r163Pw4MHbj9mrVy+aNWtGpUqVmDp1ao5/vjbr9Gn0J2P4kWfo+GUrHH7dMaWMUoMjK1XKGJWybp2x11s+kOvjwLXWM4GZYHRiZniyFdaTPXLkCHXq1LnrWOHChSlfvjwnT540e02xYsVo3749FSpUIDg4mHbt2tGtWzezGz4cPHiQnTt3cvPmTWrVqkXbtm0B+Ouvvzh8+DD+/v4cO3aMxYsXs337dlxdXenTpw8LFiygVatWjBgxgj179lCkSBGaN29OrVq17nmOF154gSFDhtCxY0fi4+MxmUyMGzeOiRMnsmbNGsD4o5FqxIgR1KpVixUrVrB582ZefPHF2+u3/P3332zZsoWYmBiqVq3Km2++iaura8Y/Y3ujNbdefZNbic781OBzFne0dkDCYvr2NTaAeOcdaNMGq+5+kQey+yf5klKqDEDKv5ctF1Le0lqjlMr08VTffvstmzZtol69ekycOJFevXqZPe/pp5/G09OTEiVK0Lx5c/766y8A6tWr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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.060256\n",
       "x1                  0.504174\n",
       "np.sin(x1)          0.488781\n",
       "I((x1 - 5) ** 2)   -0.021439\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.732256\n",
       "1    10.568384\n",
       "2    10.293669\n",
       "3     9.951793\n",
       "4     9.600256\n",
       "5     9.296301\n",
       "6     9.082893\n",
       "7     8.978207\n",
       "8     8.971173\n",
       "9     9.024187\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
