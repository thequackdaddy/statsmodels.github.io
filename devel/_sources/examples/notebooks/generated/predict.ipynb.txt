{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.985\n",
      "Model:                            OLS   Adj. R-squared:                  0.984\n",
      "Method:                 Least Squares   F-statistic:                     1014.\n",
      "Date:                Mon, 16 Dec 2019   Prob (F-statistic):           5.22e-42\n",
      "Time:                        17:55:12   Log-Likelihood:                 3.7126\n",
      "No. Observations:                  50   AIC:                            0.5747\n",
      "Df Residuals:                      46   BIC:                             8.223\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.0299      0.080     63.006      0.000       4.869       5.191\n",
      "x1             0.5059      0.012     41.092      0.000       0.481       0.531\n",
      "x2             0.4951      0.048     10.230      0.000       0.398       0.593\n",
      "x3            -0.0211      0.001    -19.517      0.000      -0.023      -0.019\n",
      "==============================================================================\n",
      "Omnibus:                        0.549   Durbin-Watson:                   1.968\n",
      "Prob(Omnibus):                  0.760   Jarque-Bera (JB):                0.222\n",
      "Skew:                           0.159   Prob(JB):                        0.895\n",
      "Kurtosis:                       3.071   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.50240487  4.98803555  5.43434685  5.81435432  6.11081203  6.31904608\n",
      "  6.44772248  6.51742337  6.55726539  6.60011596  6.67719321  6.81293693\n",
      "  7.02099322  7.30197244  7.64334893  8.02151896  8.40567874  8.76288541\n",
      "  9.06346944  9.28590926  9.4203672   9.47030578  9.45191883  9.3914709\n",
      "  9.32098204  9.27296703  9.2750933   9.34563519  9.49047159  9.70212004\n",
      "  9.96096605 10.23848573 10.50193219 10.71971574 10.866594   10.92781915\n",
      " 10.90156095 10.79920745 10.64349396 10.46476771 10.29600187 10.16737819\n",
      " 10.10132816 10.10884764 10.18769025 10.32273643 10.48847755 10.65320693\n",
      " 10.78422911 10.85323166]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.82597868 10.66733436 10.39671606 10.05837348  9.71055478  9.41124542\n",
      "  9.2039713   9.10714207  9.10954383  9.17308469]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.029861\n",
       "x1                  0.505922\n",
       "np.sin(x1)          0.495136\n",
       "I((x1 - 5) ** 2)   -0.021098\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.825979\n",
       "1    10.667334\n",
       "2    10.396716\n",
       "3    10.058373\n",
       "4     9.710555\n",
       "5     9.411245\n",
       "6     9.203971\n",
       "7     9.107142\n",
       "8     9.109544\n",
       "9     9.173085\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
