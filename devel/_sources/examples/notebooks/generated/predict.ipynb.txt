{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.989\n",
      "Model:                            OLS   Adj. R-squared:                  0.988\n",
      "Method:                 Least Squares   F-statistic:                     1328.\n",
      "Date:                Fri, 13 Dec 2019   Prob (F-statistic):           1.14e-44\n",
      "Time:                        20:00:51   Log-Likelihood:                 9.5073\n",
      "No. Observations:                  50   AIC:                            -11.01\n",
      "Df Residuals:                      46   BIC:                            -3.367\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.0119      0.071     70.496      0.000       4.869       5.155\n",
      "x1             0.4937      0.011     45.030      0.000       0.472       0.516\n",
      "x2             0.5126      0.043     11.891      0.000       0.426       0.599\n",
      "x3            -0.0189      0.001    -19.582      0.000      -0.021      -0.017\n",
      "==============================================================================\n",
      "Omnibus:                        2.113   Durbin-Watson:                   2.159\n",
      "Prob(Omnibus):                  0.348   Jarque-Bera (JB):                1.272\n",
      "Skew:                           0.341   Prob(JB):                        0.530\n",
      "Kurtosis:                       3.382   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.54064917  5.01943049  5.45850426  5.82993605  6.11587284  6.31147618\n",
      "  6.42571716  6.47990246  6.50417377  6.53255553  6.59736487  6.72390196\n",
      "  6.92629329  7.20517069  7.54756757  7.92904925  8.31772756  8.6794999\n",
      "  8.98365227  9.20790549  9.34207554  9.38974684  9.36768331  9.30307409\n",
      "  9.22906648  9.17931988  9.18247571  9.25745164  9.41033352  9.63337547\n",
      "  9.90627251 10.1994966  10.47914804 10.71252508 10.8734967  10.94679591\n",
      " 10.93052804 10.83648204 10.68819359 10.51707824 10.35726996 10.24001297\n",
      " 10.18852847 10.21419939 10.31470026 10.47437928 10.66682981 10.85922898\n",
      " 11.01773034 11.11302476]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[11.11540157 10.98325622 10.73668962 10.42150923 10.09801375  9.82622994\n",
      "  9.65121596  9.59202956  9.63706206  9.74688059]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.011943\n",
       "x1                  0.493739\n",
       "np.sin(x1)          0.512566\n",
       "I((x1 - 5) ** 2)   -0.018852\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    11.115402\n",
       "1    10.983256\n",
       "2    10.736690\n",
       "3    10.421509\n",
       "4    10.098014\n",
       "5     9.826230\n",
       "6     9.651216\n",
       "7     9.592030\n",
       "8     9.637062\n",
       "9     9.746881\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
