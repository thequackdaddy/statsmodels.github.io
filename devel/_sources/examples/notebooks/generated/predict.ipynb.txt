{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.980\n",
      "Model:                            OLS   Adj. R-squared:                  0.978\n",
      "Method:                 Least Squares   F-statistic:                     736.6\n",
      "Date:                Sat, 30 Nov 2019   Prob (F-statistic):           7.15e-39\n",
      "Time:                        00:13:38   Log-Likelihood:                -3.4191\n",
      "No. Observations:                  50   AIC:                             14.84\n",
      "Df Residuals:                      46   BIC:                             22.49\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.1105      0.092     55.506      0.000       4.925       5.296\n",
      "x1             0.4943      0.014     34.813      0.000       0.466       0.523\n",
      "x2             0.4906      0.056      8.789      0.000       0.378       0.603\n",
      "x3            -0.0204      0.001    -16.344      0.000      -0.023      -0.018\n",
      "==============================================================================\n",
      "Omnibus:                        3.333   Durbin-Watson:                   1.999\n",
      "Prob(Omnibus):                  0.189   Jarque-Bera (JB):                1.785\n",
      "Skew:                           0.155   Prob(JB):                        0.410\n",
      "Kurtosis:                       2.128   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.60107671  5.07735696  5.51485264  5.88682523  6.17618599  6.37830361\n",
      "  6.50176512  6.56696506  6.60275472  6.64170196  6.71474039  6.84608706\n",
      "  7.0492637   7.32487511  7.66050978  8.0327791   8.41116004  8.76300997\n",
      "  9.05892977  9.27759401  9.40925469  9.45734277  9.43790448  9.37696501\n",
      "  9.30625257  9.25798562  9.2595794   9.32914172  9.47249789  9.68223364\n",
      "  9.93891324 10.21427277 10.4758638  10.69238454 10.83882267 10.90056478\n",
      " 10.87579731 10.77580452 10.62311452 10.44779794 10.28252746 10.15720972\n",
      " 10.0940718  10.10400933 10.1847964  10.32145126 10.48869776 10.65511819\n",
      " 10.78831508 10.86023404]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.8378129  10.6854627  10.42242384 10.09254271  9.75353663  9.46286257\n",
      "  9.26364972  9.17413996  9.18322159  9.25314989]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.110486\n",
       "x1                  0.494326\n",
       "np.sin(x1)          0.490623\n",
       "I((x1 - 5) ** 2)   -0.020376\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.837813\n",
       "1    10.685463\n",
       "2    10.422424\n",
       "3    10.092543\n",
       "4     9.753537\n",
       "5     9.462863\n",
       "6     9.263650\n",
       "7     9.174140\n",
       "8     9.183222\n",
       "9     9.253150\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
