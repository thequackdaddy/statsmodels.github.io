{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.984\n",
      "Model:                            OLS   Adj. R-squared:                  0.983\n",
      "Method:                 Least Squares   F-statistic:                     964.4\n",
      "Date:                Thu, 05 Dec 2019   Prob (F-statistic):           1.63e-41\n",
      "Time:                        19:06:08   Log-Likelihood:                 3.8072\n",
      "No. Observations:                  50   AIC:                            0.3855\n",
      "Df Residuals:                      46   BIC:                             8.034\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.1699      0.080     64.883      0.000       5.010       5.330\n",
      "x1             0.4798      0.012     39.040      0.000       0.455       0.504\n",
      "x2             0.5190      0.048     10.743      0.000       0.422       0.616\n",
      "x3            -0.0190      0.001    -17.612      0.000      -0.021      -0.017\n",
      "==============================================================================\n",
      "Omnibus:                        2.712   Durbin-Watson:                   1.987\n",
      "Prob(Omnibus):                  0.258   Jarque-Bera (JB):                1.746\n",
      "Skew:                          -0.224   Prob(JB):                        0.418\n",
      "Kurtosis:                       2.201   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.69487483  5.17109166  5.60713102  5.97470779  6.25574481  6.44534287\n",
      "  6.5525857   6.59904748  6.61524831  6.63563981  6.69294483  6.81278118\n",
      "  7.00945269  7.28359914  7.62209114  8.00018724  8.38559892  8.74379545\n",
      "  9.04367722  9.26268532  9.39050791  9.4307744   9.40045915  9.32709268\n",
      "  9.24423843  9.18597839  9.18131355  9.24939909  9.39639728  9.61446497\n",
      "  9.88304227 10.17223043 10.44770414 10.6763511  10.83171222 10.89832884\n",
      " 10.8742825  10.77151016 10.61384298 10.43309093 10.2638165  10.13765619\n",
      " 10.07812271 10.09674193 10.19115917 10.34552612 10.53310463 10.72065974\n",
      " 10.87392006 10.96320851]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.95683127 10.8142859  10.5559257  10.22813319  9.89196414  9.60819891\n",
      "  9.42246135  9.35404846  9.39120584  9.49400554]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.169939\n",
       "x1                  0.479751\n",
       "np.sin(x1)          0.519002\n",
       "I((x1 - 5) ** 2)   -0.019003\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.956831\n",
       "1    10.814286\n",
       "2    10.555926\n",
       "3    10.228133\n",
       "4     9.891964\n",
       "5     9.608199\n",
       "6     9.422461\n",
       "7     9.354048\n",
       "8     9.391206\n",
       "9     9.494006\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
