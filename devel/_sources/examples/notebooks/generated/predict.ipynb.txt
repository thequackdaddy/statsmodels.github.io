{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.981\n",
      "Model:                            OLS   Adj. R-squared:                  0.980\n",
      "Method:                 Least Squares   F-statistic:                     797.5\n",
      "Date:                Wed, 04 Dec 2019   Prob (F-statistic):           1.19e-39\n",
      "Time:                        16:01:18   Log-Likelihood:                -3.7885\n",
      "No. Observations:                  50   AIC:                             15.58\n",
      "Df Residuals:                      46   BIC:                             23.23\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          4.9425      0.093     53.286      0.000       4.756       5.129\n",
      "x1             0.5067      0.014     35.418      0.000       0.478       0.535\n",
      "x2             0.5487      0.056      9.758      0.000       0.436       0.662\n",
      "x3            -0.0200      0.001    -15.901      0.000      -0.022      -0.017\n",
      "==============================================================================\n",
      "Omnibus:                        2.275   Durbin-Watson:                   1.888\n",
      "Prob(Omnibus):                  0.321   Jarque-Bera (JB):                1.833\n",
      "Skew:                          -0.469   Prob(JB):                        0.400\n",
      "Kurtosis:                       2.978   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.44318618  4.94597576  5.40632617  5.79433175  6.09087965  6.29078997\n",
      "  6.40366687  6.45232059  6.4690198   6.49018994  6.55042865  6.67682146\n",
      "  6.8844917   7.17411581  7.53181218  7.93142186  8.33880641  8.71745676\n",
      "  9.03449151  9.26605929  9.40125745  9.44392335  9.41200387  9.33460682\n",
      "  9.24721857  9.18587378  9.18123498  9.25355481  9.40934858  9.6403238\n",
      "  9.92474264 10.23099336 10.52278408 10.76510537 10.92998226 11.00107039\n",
      " 10.97634141 10.86841617 10.70249118 10.5121989  10.334082   10.20158953\n",
      " 10.13958129 10.16024351 10.26108661 10.42535427 10.62477645 10.82421405\n",
      " 10.98743221 11.08305354]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[11.07785685 10.92875089 10.65725501 10.31240915  9.95876712  9.66059155\n",
      "  9.46612021  9.39575569  9.43707013  9.54784802]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXAAAAD4CAYAAAD1jb0+AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nO3de3yO9f/A8ddnJ5vDzGFOWxjJIbONOed8DF/Hb0RJqfwKHeTwlYp1tCJSqZBTTslpikKIpMRkIueKbMQam9n58Pn9cduyuTez+959fD8fjz1s1677vt6Xa94+e39OSmuNEEII++Ni7QCEEEIUjyRwIYSwU5LAhRDCTkkCF0IIOyUJXAgh7JSbJS9WuXJlXbt2bUteUggh7N7Bgwf/0Vr75j9u0QReu3ZtIiMjLXlJIYSwe0qpc8aOSwlFCCHslCRwIYSwU5LAhRDCTlm0Bm5MRkYG0dHRpKamWjsUUQSenp74+/vj7u5u7VCEcHpWT+DR0dGUK1eO2rVro5SydjiiEFpr4uLiiI6OJiAgwNrhCOH0rJ7AU1NTJXnbCaUUlSpVIjY21tqh2KWIQzHM2HqSC/Ep1PDxYmKP+vQP8bN2WMKOWT2BA5K87Yg8q+KJOBTDi+uPkJKRBUBMfAovrj8CIElcFJt0YgphATO2nsxN3jlSMrKYsfWklSISjkASOODq6kpwcDD33nsvQUFBzJo1i+zs7EJfc/bsWVauXGmhCIW9uxCfckfHhSgKmyih3ImSqCN6eXkRFRUFwOXLlxk2bBgJCQm8+uqrBb4mJ4EPGzbMpGsLx5T/59SntDtXkzNuOa+Gj5cVohOOwq5a4Dl1xJj4FDT/1hEjDsWY7RpVqlRh/vz5fPjhh2itOXv2LO3ataNp06Y0bdqUH3/8EYDJkyezZ88egoODmT17doHnCedj7Of0emom7q55+w+83F2Z2KO+dYIUDsGuWuCF1RHN2RFUp04dsrOzuXz5MlWqVOHbb7/F09OT06dPM3ToUCIjIwkPD2fmzJls2rQJgOTkZKPnCedj7Oc0I1vj4+VOmVJuMgpFmM1tE7hSahHQB7istW5849gDQBjQEGihtbZIprJkHTFnr9CMjAzGjh1LVFQUrq6unDp1yuj5RT1POL6Cfh4TUjKImtbdwtHYkMxM+PRTCA+H69fBw8PwUaqU4U8vL3jkERgzBmS0U5EUpQW+BPgQ+OymY0eBgcC8EoipQDV8vIgx8o/D3HXEP/74A1dXV6pUqcKrr75K1apVOXz4MNnZ2Xh6ehp9zezZs4t0nnB8lvo5tXW5/QBXkxl06QhT9yzB+49THK7VmMO1GlPeFUKqelGzrBukp8P58/DMM/D117B4MVStau1bsHm3TeBa6++VUrXzHTsOlh8TPLFH/TxjacH8dcTY2Fieeuopxo4di1KKhIQE/P39cXFxYenSpWRlGa5drlw5EhMTc19X0HnC+UzsUZ+w1ZF0ObKbmvF/c65CNS763sXw7l1Ba6doXeb0A9SKOcNnOxfS7lwUZyvUYPKgl/i6bqvcvwMvd1emDww0lJK0ho8+ggkTIDDQkMR797byndi2Eq+BK6VGAaMAatasadJ75dQLzT0KJSUlheDgYDIyMnBzc2P48OG88MILAIwePZpBgwaxZs0aOnXqRJkyZQBo0qQJbm5uBAUF8eijjxZ4nnAstx0FdeYM/Vd8Qq8Fn+JxLSHvi5cAPj7QtSu8+y6Y+O/Bls3YepJOR3Yz56sZJHl48VrnJ1nWtBfpLu6knq2MR7UEXL0y8vZhKWUon3TsCMOGQZ8+hq9nzDCUV8QtVE6tt9CTDC3wTTk18JuO7wImFLUGHhoaqvN37B0/fpyGDRsWMVxhC5z1meWfTQk3tSCzLsIrr8CWLeDmBgMGwOjR0Lo1/PknnD5t+DhxAlasMCSrN98kou0AZmw/43Adm+P7vMA7X8/hUI36PDHoFa56epNyqhoJ++qS/rcPPh2OU77VHwAo4M/wfC3t1FSYMgVmz4ZGjWDtWnDCn7kcSqmDWuvQ/MftahSKENZU0CioHR99Tv+VU6FcOQgL4+p/n2T5zhp8+pwhd9es2YBatRpQuzbUuhu6fDaFZgtHw/PPU7f6XMr3eIaYqnUcZ3r9xx/z7ubZ/FAriCf6TeWfM3VJ2FeXzCtlcfNJomKPXynb+N+hv0b7Bjw9YdYs6NkThg+HXr3g4EGoWNGCN2L7JIELUUTGRpd0+OMgMza8iW5wDz++up2P11dlbTNIS4NmzWDECEPf3Llz8NNPcPUqQG0G9N/MPX3eYPzOWXy59Hk+aPMgc9oOLZFhseZWaBnp3XdhwgT+bteVx+u+yB+ftSQzvgzuVRKo2u8QZRteJPOm3/pv24fVvTt8+SW0a2cYofLll+BiV9NXSlRRhhGuAjoClZVS0cA04ArwAeALbFZKRWmte5RkoEJYW/7RJd1P/cSHG9/mzyoBvOL7HWsGVaZ8eXjiCXj8cQgJufU94uMN/XRvvaXYkDqFz4N6MSt5EuP2rsQnNZFXu4yy6en1hS7K9dVCmDYNBg/m5weWc264Ky6l0qny3wPUbZrIpJ71gSp33ofVsqWhlDJ2rGEI4pQpJXyX9qMoo1CGFvCtDWaORQibdvMoqD7Hv+e9r2ZytGp9hpTawandFanY5TfqdYila596hBSQlHx8DPnnsccg+D+XOHewKQ94bWZuwBM8dXAFHlkZfPzAeAvfWdEVVEY6/eoM2DgHPWIEM+ovZPJgV5o3h4gIT6pXb57n/GL9djF6NOzda+hnaNkSunQx5TYchpRQhCiinMRzcMY8wr6ayeEagfRL307MBR+qDIzEq24sfydRpDp29eowb4Fm3NyfuLilAU//uYzkGmV4IWo+993lDVmdwNXVIvd1JwoqI4378gOyevXh8ayFLJ3iypAhhlGAZhs8ohTMnw+HD8PQofDLL+Dvb6Y3t19STBLiDvT3TuX1r2aTHNiaAal7+TvZm6oP7sOr7r+bXBR1mdj+IX7MHlOLkKcPUzYwmvEXPmFJvSnU+uoLQ703M7Mkb6VY8nc4Nrj8Jx9uDOdM1br0il/F0uWuhIXBqlUlMPKvbFlYtw5SUmDwYMPkHyfn9Ak8Li6O4OBggoODqVatGn5+frlfp8sPiLhZZiYMH06GdiX01EpcvctQddiPlKqRcMupRa1j9w/x46eXOnHt8F2EhSkeO/0mi+5+C1auhIcfhhvLGkcciqFt+E4CJm+mbfhOsy7gdicm9qiPl7vhNwPf61dYuPY1kjzK8FTFLezcX5aVKw1l8BKbq9SgASxcaOgRnjSphC5iP5y+hFKpUqXcpWTDwsIoW7YsEyZMyHOO1hqtNS7S++1U8o+2+PTc1zT86SeeLrMKj7trsvtbGLQkm5j4W197p9PmlTIkvpo14cknX+RadReeXz0ZqlYlYsREXtxw1CZ288m53gdfRTF76WtUSEtkRL1d7Dleh1WrDA3jEjd4MPz4I8yZA23bwgMPWOCitkkyUgHOnDlD48aNeeqpp2jatCnnz5/Hx8cn9/uff/45TzzxBACXLl1i4MCBhIaG0qJFC/bt22etsIWZ5F8Stspvh6g3bzYbyw9ljeuDRERAtWp5W6Q5TFne4bHHYPNmeOXaJBZ6j4P33yfmpddsajef/k2qsePQpwRe/oN3Atew7lhLFi+2UPLO8c470KKFoXPzyhULXti22FQL/Pnn4UZj2GyCg+G994r32mPHjrF48WI++eQTMgupRz777LNMmjSJVq1acfbsWfr06cPRo0eLGbGwBTePtiidnsLsTe8S416dRxI+ZvE6qFvXcF5JLO/Qowfs2Kno3nUmVcpeZMyWBfzuWpb1jfOOvLDacMNJkyAigoWBc3j1YB/mzTOU7C3Kw8PQqdm0Kbz0Enz8sYUDsA02lcBtTd26dWnevPltz9u+fTsnT/7bGrp69SopKSl4yfoNduvm5Dh1xwJqxv9NB3ZDaBwDB5bPc27/ED+zlzJatIAt21zo020JX7j/zdvfvE9caR9212mWe055L3fahu+07DT8Tz6BWbPYUu8ZnjzyLO+/D6NGlcxOWbcVFATPPmsopYwcCUX4t+pobCqBF7elXFJuXpDKxcWFm9eNSU1Nzf1ca83+/fvx8PCwaHyi5ORM2ul2eh8P/rqN6S7/40C1xoT0jwLqWCSGVq1g45ZSDOi6gW3ZHfhow3QeHDadI9Xr4e6iSErPJD7FsE2bReriW7eix47lsH9vep+ezdtvG1Z/LXRyT0kn8VdfhdWr4emn4eefbXLoZUmSGngRubi4UKFCBU6fPk12djYbNvw7j6lr167MnTs39+soc9eBhMVN7FGfijqDsG/ncdg1kFc9XsZ/0GH+1+sei8bRti2s2+ZDP7dvuJxdjaVfTOO+tEuU9XQjIyvvQnQpGVmEfflbsUerFDrS5cgR9AMPEO0TyH3RnzM1zDV3EEhhO2WVOG9vw5opBw/CPItuT2ATJIHfgbfffpuePXvSpUsX/G+aRDB37lz27t1LkyZNaNSoEQsWLLBilMIc+of4sfLqLvwSYxmTNZc6Q88w87F6VlmjpF07WLqlBn3ct5ORWZalK6ZQIfqs0XPjUzKKtWdsofvNXryI7t2ba9nlaB33FWP/V5apU/99rSV3yjJqyBDo3NlQC7982TLXtBFFWk7WXGQ5WcfgFM/szz/JbtCQVemDiHx+BbNnWzsg2LULxvc6zra0DmSUUfz3oelEl7/9rjV+Pl7sndy50HPahu80uotQg1KZbNn8Omm/nqBVxh7aPxvCe+/lHedd0GuLcl2zOXECmjQxrCO+ZIllrmlBBS0nKy1wIbi1fBD92GhSM9yYU+MdXn/d2tEZdOwIc3c2pF/pbyl1PYMVK1+hauI/t32dsZZw/vs1loArJifw7icvkPbLEQZkfMHF5lXoOCLmlkk65h5KWSwNGhh28lm6FPbssdx1rUwSuHB6+csHtaN+wn/3Fl7XLxG2wI+yZa0d4b9atYIPvg9iiPcWKiYm8vmqafgmXcXPx4sKpd2Nvib/pCJj5ZL8Eyd9r1/h85UvEhB7gf/or/j+3iaU6hjFlA23lmT6h/gxfWAgfj5eKAwt79xt0izppZcMM6FGj4aMDMte20psahSKENZwcyecW1YmU7cu4Ax1+azxMKb3snw8txuSFxIC7/3YguHtv2ZFXA/2bJiG5+b1RGRXLtKescY6HTWGnXE0UOPaZVasehnfhHju11uIauFPpY6HUYoC1ysviaGUd6xMGcOQwgED4P33YbztrupoLtICF07v5hLDw79spn78Oca7zcC14ymLx1JoZ+JNGjWCd3++j+HVthMXk0pmaCv6Rm0vUku4oM5FDbTIusrqZS9SISGJrvpbjvaoQIVOJ/KUTWx5vXL69TPs3hMWBhcvWjuaEicJXDi9nBJDpaR4xn3/OVvowQ9d6nCXn+XHFN/JkLy6dWH+kdZM6XmI7zNb4zLyUbrNfp29z7fhz/De7J3c2Wir2Ng6LUpn83+nv2PFp+MonZRJvzI7SXzci3LB54v0epuhlKEVnp7uFItdSQIXTi+nE27czlWUzkxhUrUwfEMvWrYT7oY7HZJXuTIs+boKZ+ZuY4bbZMosm8fVwHaGURkFyN/pGHThJBFLJvHi+nfZH1+fIdX38PHPTXlzTBXrd04Wx913Gzo0ly+HH36wdjQlShI4EB0dTb9+/ahXrx5169blueeey11KdteuXfTp0+eW12zatImQkBCCgoJo1KgR8ywwiWDJkiWMHTsWgE8++YTPPvuswHPPnj3LypUrc7+OjIzk2WefLfEY7VH/ED8+bOLO0GPfMFeNxm0YhA+yQiccBbduC2v1KgWjRrvR59fpjAuIwOXMKWjYkH/uaU3a7I8gLi7P+f1D/Jg+oDFB6jrhX37IxmXj8b2cwKOuy/jimT18frghjRrZUOdkcUyZYtjw4ZlnICvr9ufbq5ylUi3x0axZM53fsWPHbjlmSdnZ2bp58+Z60aJFWmutMzMz9ciRI/WECRO01lp/9913unfv3nlek56erqtXr67Pnz+vtdY6NTVVnzhxoljXz8zMLPK5ixcv1mPGjCnSucbiNhdrP7OS8E+LnvoKPvqtCXFWjWPDL9G6wcvf6Fr/25T70eDlb/SGX6KL9PrUVK3fHndRv1buHX2YQK1BZ7i46wst+ulLg57Sf4f20nE17tWpHmW1Bp2Om56hJuoxj1zT586V8M1Z2urVWoPWH31k7UhMBkRqIznV6RP49u3bdbt27fIcS0hI0BUrVtRJSUlGE2FcXJz29fXVycnJhb73tGnT9MMPP6w7deqk7777bj1//nyttSG5duzYUQ8dOlQ3bNhQa631smXLdPPmzXVQUJAeNWpUbmJftGiRrlevnm7fvr1+4oknchP4tGnT9IwZM7TWWp8+fVp36dJFN2nSRIeEhOgzZ87oli1bam9vbx0UFKRnzZqV5z7i4uJ0v379dGBgoG7ZsqU+fPhw7ns+9thjukOHDjogIEDPmTPH6H1Z+5mZW8bmrVqDfr3Cu/o2j9QiNvwSrdtM36Fr/2+TbjN9R5GT980yM7X+7jutX/9vlP7Qa7yOpob+h4r6ICF6Pf31bJ7TL5Wepcf/56Q+dcr892ATsrO17tRJ6woVtI6NtXY0JikogRdlV/pFQB/gsta68Y1jFYHVQG3gLDBYa33V5F8HrLCe7G+//UazZs3yHPP29qZmzZqcOXPG6GsqVqxI3759qVWrFl26dKFPnz4MHTrU6IYPv/76K/v27SMpKYmQkBB69+4NwP79+zl69CgBAQEcP36c1atXs3fvXtzd3Rk9ejQrVqygW7duTJs2jYMHD1K+fHk6depEiJGtzh966CEmT57MgAEDSE1NJTs7m/DwcGbOnMmmTZsAQykox7Rp0wgJCSEiIoKdO3fyyCOP5K7fcuLECb777jsSExOpX78+Tz/9NO7uxscX26ubh+n5e3uwcvY40qlDyKdjzL8NWDGYY0ieq6th4k/HjkFkZgaxe/dMkpIMa5iHVofeVQ0rsjo0peCDDwyrFr70kkOulVKUGvgSoGe+Y5OBHVrresCOG1/bJa01ysj+TwUdz/Hpp5+yY8cOWrRowcyZMxk5cqTR8/r164eXlxeVK1emU6dO7N+/H4AWLVoQEBAAwI4dOzh48CDNmzcnODiYHTt28Mcff/Dzzz/TsWNHfH198fDwYMiQIbe8f2JiIjExMQwYMAAAT09PSpcuXeg9//DDDwwfPhyAzp07ExcXR0KCYVuw3r17U6pUKSpXrkyVKlW4dOlSoe9lb/IP02v17Tfc9c8xFjR4jd4DS1k7vBLh5mbYxL1vX8MytXfd5QTJO8e99xrq4AsWGBa8cjC3bYFrrb9XStXOd7gf0PHG50uBXcD/TI7GCuvJ3nvvvaxbty7PsWvXrnH+/Hnq1q1LXL4OoJsFBgYSGBjI8OHDCQgIYImRNRjy/yeQ8/XNS9VqrRkxYgTTp0/Pc25ERESh/4nkvPZOGXtNznVKlfo3ibm6uha6kYU9yr9Rw/g9K9hLa77tU5twK8cmSkhYmGGP0bFjYe9ecKCtEYt7J1W11hcBbvxZpaATlVKjlFKRSqnI2NjYgk6zmi5dupCcnJw7oiMrK4vx48fz6KOPFtiSvX79ep6SRFRUFLVq1TJ67saNG0lNTSUuLo5du3YZ3SCiS5curF27lss3VlK7cuUK586do2XLluzatYu4uDgyMjJYs2bNLa/19vbG39+fiIgIANLS0khOTqZcuXIkJiYajal9+/asWLECMJRWKleujLe3dwF/Q47l5uF4I7d9Q7Wsy0xr8jxXXI1sbCkcQ/ny8PbbsG8fLFtm7WjMqsT/K9Jaz9dah2qtQ319fUv6cndMKcWGDRtYs2YN9erV45577sHT05O33nor95wdO3bg7++f+3Ho0CHeeecd6tevT3BwMNOmTTPa+gZDqaR37960atWKV155hRo1atxyTqNGjXjjjTfo3r07TZo0oVu3bly8eJHq1asTFhZG69at6dq1K02bNjV6jWXLlvH+++/TpEkT2rRpw99//02TJk1wc3MjKCiI2fmW0gsLCyMyMpImTZowefJkli5dWvy/QDuTMxyvSnwco39bxRfuAzndrZxtT04RpnvkEcNCMhMmwN9/WzsasynScrI3SiibburEPAl01FpfVEpVB3ZprW87ut/ZlpMtaJd7e2fPzyynBh42/yP6X95K2/tXk9TM037GN4viO3YMmjWDTp0MO0ffpjxpS8y9nOyXwIgbn48ANhY3MCHMpdAdZW7oH+LHm56pDLn8Fe9VfJpS7b0leTuLRo0Mu9l/841hb08HcNsWuFJqFYYOy8rAJWAaEAF8AdQE/gIe0Fpfud3FnK0F7qhs8Znl35cRDNO+8yfn7LQMzlZsinvKNdxOH6d63cJH7AgHk51tWOzq++/h0CGob+PLAtxQ7Ba41nqo1rq61tpda+2vtV6otY7TWnfRWte78edtk/dtrmHKy4UF2eqzKuoiUPuGz6VO8lFOjp4jydsZubjAokVQujQ89JDdrxtu9fXAPT09iYuLo1KlSrcdMiesS2tNXFwcnp6eeY7fbv1qSyhosaeY+BTahu/kQnwK9yRlsmbNVH6udD9d3u9n0fisyRaej02pUQPmz4dBgwy72r/xhrUjKjarJ3B/f3+io6OxxSGG4laenp55NnTOX7rIWb8aMFuSKEoCquHjZXRbMHUjJq1hxJLllCKN3998hZYuztFYsMTzsUsDB8Jjj8H06XD//dC2rbUjKharJ3B3d/fcGYnC/hRWujBHgihqAprYo/4tNfCcHWYAgn64yLDra5lZ6//YcDWFYSZHZh9K+vnYtTlzYPduGD7csISHHc6FcJwpScIq7nT96jtV1Nq2saVPc5K3uq5486f3OOt6FwsGdLPtHWXMrKSfj10rV84wsefcORgzBmy0f6cwVm+BC/tWUOnCXBNj7iQB5V8Eqm34TqKvpjD88x8J1L/xWIc3SSvliZ8TTdop6edj99q0MUy1nzoV3N0NtXE3+0mL0gIXJsm/uwuYd9eW4mxwcHNsjbYlMTXubTZW6cZ3oU3sY0cZMyrp5+MQXn7ZkMQXL4bBgyE11doRFZkkcGGSkt61xZQEVPpUaT6JmsgFjxq88uDj+FUo7XSTdux6Vx1LUQqmTTPUxDdsgN69oYB1hIolMxNWrSqRIYtFmkpvLsYm8ghxO8UZBnfmtOb4vYPomfEVWbv34tm+hYWiFXZt2TLD6JSmTQ0zNitVKv57aW34D+Gllwx7lH7+ORhZErooCprIYz/FHmE3zD3u+E43OEhKgi86zGVKxgbiprxLJUneoqiGDzesXjh4MLRvD9u2gV8xfnZ37IAXX4QDB6BBA1i3Dm6s2W9OUkIRpktIMKyzfOECEb9E59kwIWfYn7F1SUqC1vDGoEOMvzie2Ba9qfTGOItcVziQvn1hyxY4f96w+NWECYZEXJRqxYED0K0bdO1qWPVw0SI4csQw7rwEJipKCUXcuYQE+OEH2LULdu1C//ILKjsbgKtlfDjiG8DxKgEcrVqXb+u1JNXdMPJj7+TOt31rU1rv2dkw7YVEHpnTlKreKXj/HgWVK5typ8KZHToEr7xiaIVnZEDt2oaW+eDBhhJLdLRhl59ffjF8HDxoSNqVKxvKJk89BflmLRdXQSUUSeCi6LQ27Cv4/POQlkaWmwenKrTiq8SO/JDajJr8RTCHCHY5ROPsY3iSRpxHeZaF9GJF814c+ODhQt++qAtSGZOaCmMfusqj6/9DG/UT6rvvUB3am+W2hZOLj4eNG+GLLwzJPDPTsJZKcrLh+y4u0LChobXesqWhDFOunFlDkAQuTJOaCqNHw+LF/OTTk5fiJ/ETrShf1YtevQxLLCclwZtfnOVqrBvqmivNLx/l2dS59OVL0pUH//R8hOozXsD13gZGL9E2fKfRMcu3a73HxcET98fw2oGeNHI9icuK5aghg81260LkunLFkMwjIw3L0zZtatg0+Tb70JpKErgoVKGli7/+MtTwDh5kutsrfOQ7jVFPu9KrF4SE5N1i8OZWtM6GtPOV8I9K5akzq3g4cykepHO00RB854ZRvWPeoYABkzdj7KdRAX+G9zYa9++/w+iup5h/tjs1PONw3xRh2MFXCAcio1BEgQpdb+TqSfSQIaQlpDGECBLa9iNyNVStavy9cpJ+zn8GdYOSmTipPj0bzmP7ytdJnv4evY69j1enL/jurodxf30qbYbXxcXlzmYNpqYaRmWtGBfJqoT78fZRuG/fZfg1VggnIS1wUWDpos+Vk3ywaBJnPe6hZ8oG+rxQn/Bww4xjU/wVeZmzY96h+f65uJPBhnIjiOnzf1xtE8Dn0YdI498JD/lr4NHR8PHHsPzDf/jvtaWEqTCulSvHsc9W061fO9MCE8JGSQlFFMhY6aJicgJfL3yWpLRKtPU4wJzF3sWdg1CgtLMX+fP/wgnYPp9S2amcoh6fuw4jwr83f9b0xruMK/fVqcLdlb3JyIBTp+D3Db8yOvsDHlIrKK1T+LFmE57vM57EilVkhqFwWJLARYHyt8CVzmbRmtdo/ecRupXdx0c/BhMYaNo1Cq2xJySQtnId1+etoMLh73BBE0UQcVQiHQ/SKEW6KkVtt2haZPxIqlspNjTqwLKmfThWtU7uNYo6VFEIeyM1cFGg/GtpP7E/gk5/RjKGD5m4wjzJu9A1vcuXp9TTIyn19EhDjWTVKhpv+RaVkozKSESlp6HS0gxjah+eQavz/sR73TpMS5ZIFc5GErjI0/FY5VgUk3Z/xnoGUG7SaPr2Nf3972hTAX9/mDgRt4kTC3y/MuE7iZclUoUwLYErpZ4DnsQw0muB1vo9s0QlLK5/iB/9A8qQ3vhxLuDHojYLeey/F2gbnrfsAdzxTElzbypgbPcdWSJVOKNiJ3ClVGMMybsFkA5sUUpt1lqfNldwwoK0JmPkKFxizjOm4h4GhaXy8pd5yx4T1xwGBRlZOvdYUfZXNPemAvmHKspGvcJZmdICbwjs01onAyildgMDgHfMEZiwLP3VJtw3rOFFNZ2J69wjrEIAABZNSURBVFsz5aedt5Q9MrJv7fAuyv6KJdFivtMVCoVwRKasRngUaK+UqqSUKg30Au7Kf5JSapRSKlIpFSk7z9uorCwSx0zmJPfg89p4OnS4s/LG7c6VTQWEKBnFboFrrY8rpd4GvgWuA4eBTCPnzQfmg2EYYXGvJ0pOxsLP8I4+xtS71jJzsmGWTkFlD2OKUgqRFrMQ5mfSeuBa64Va66Za6/bAFUDq3/YmJYWUSVP5mRb0WjAwdz9XY1uZubso3F3zrmksnYdCWI+po1CqaK0vK6VqAgOB1uYJS1jK9fAP8U6IZn3L5bzd49/kXFBHobFjxW1Zm3vnHiGcjUkzMZVSe4BKQAbwgtZ6R2Hny0xMG3P1KsnV6rArvQ0BxzbTsKHlLm3K2t9COJuCZmKaWkJpp7VupLUOul3yFrYndnw4nukJHH5wukWTNxQ+uUcIUTSyJ6aT0n+dp/zSOax2H86oD5tY/PrmntwjhDOSBO6EIg7FsL7Ls+hszdz7HmXPX5bZcPhmBY1ckenwQhSdrIXi4PJ3FHZq4Mv+rZF8c+ZLPij1NOebFW02pbnJdHghTCctcAeW01EYE5+CxjD1fcW+vxjyzRYycePTzn1QrtoqtWeZ3COE6aQF7sCMdRR6J19j6LmvWOk5mMTALHIGDlqj9iyTe4QwjbTAHZixpPzg9u8pTQoLW/VD3TQnR2rPQtgfSeAOLH9S9shIZ+TJdXzj1p3zzUvnHpfasxD2SRK4A8s/Hb73ngNUzY7l+/tH4l/RU2rPQtg5qYE7sJunw1+8msT/Ra3jV7dgwr4YTClPdZtXCyFsnbTAHVz/ED/2Tu7MJl9XGmScImbIBEneQjgISeBOIiN8JjEu/rT/cLC1QxFCmIkkcCdw6vNfCIr7juPdnqOMj7u1wxFCmIkkcCdwefK7XKMczeY9ae1QhBBmJAncwZ37MYZW51ZzOPQJKtQqb+1whBBmJAncwR0fNw8Xsrnng2esHYoQwswkgTuw+MvphByYz2G/3lRtFWDtcIQQZiYJ3IH9MG4dVfUlyk0eY+1QhBAlQBK4g8rMhGprPyTa627uHt3d2uEIIUqAJHAHtePdKELTfyRh2GhwkccshCOSf9kOSGtImTmXFOVFw7cftXY4QogSYlICV0qNU0r9ppQ6qpRapZTyNFdgovh+3nKV7v+s4I82D+NSqYK1wxFClJBiJ3CllB/wLBCqtW4MuAIPmiswUXwn/reY0qRQZ6Z0XgrhyEwtobgBXkopN6A0cMH0kIQp/vw9m/uOfMRZ/7Z4tQqydjhCiBJU7ASutY4BZgJ/AReBBK31tvznKaVGKaUilVKRsbGxxY9UFMm28Vu5m9/xlqGDQjg8U0ooFYB+QABQAyijlHo4/3la6/la61Ctdaivr2/xIxW3lZAAtTbNJd6zKhWfHGTtcIQQJcyUEkpX4E+tdazWOgNYD7QxT1iiON54LoruWV+z+J6etJ31AxGHYqwdkhCiBJmSwP8CWimlSiulFNAFOG6esMSdWrM/Br+Vi8jClVX3dSYmPoUX1x+RJC6EAzOlBv4zsBb4BThy473mmykucYfeDL/AoxmfsemuTlwuVwmAlIwsZmw9aeXIhBAlxaQ9MbXW04BpZopFFJPWcN+3e/AhgWXt806bvxCfYqWohBAlTWZiOoCdOzRPX19IlHcjfvFrkOd7NXy8rBSVEKKkSQJ3ANun7ORejrGq3f2g/t2w2MvdlYk96lsxMiFESZIEbueOHoVWB94nqXRl2r78NH4+XijAz8eL6QMD6R/iZ+0QhRAlxKQauLC+z179k3C+IvWpKfRtVZe+repaOyQhhIVIC9yOXbwI1dbPRSsXSo97ytrhCCEsTBK4HZs3K4nHsheSfP8g8Pe3djhCCAuTEoodiDgUw4ytJ7kQn0INHy8m9qhP57p+JHy0nArEw4uyYbEQzkgSuI2LOBTDi+uPkJKRBZA7w7LZlTJMTv6ApPohlGnb1spRCiGsQRK4jZux9WRu8s6RdF1x7dPdNOY3eHFJnqGDQgjnIQncxhmbSZkYWYvJ6SNJq1aTUsOGWSEqIYQtkE5MG5d/JmV2mhvB+6Npw0982KIfAa9so234Tlm0SggnJAncxk3sUR8vd9fcrxMP1mZy+gwue1Vk/t0d0SArDwrhpCSB27j+IX5MHxiIn48XOs2NBvuv0INtLGzZlzT3UrnnycqDQjgfqYHbgf4hfvQP8eONN6BR2kDiPcqyPLjXLefJyoNCOBdpgduJhATYPOMYA9nA+vsGkFSq9C3nyMqDQjgXSeB24oMPYPS16WR5laHqy5Py1MVBVh4UwhlJCcUOxMbC2nf+4KBahevo5+ndqTEZPhVumZ0pKw8K4VwkgduBSZPg6eszUG6u8MILwL91cSGE85ISio3bswf2LDnD4y6LcBn5GNSoYe2QhBA2QlrgNiwjA0aPhk+8xuHqVgqmyfajQoh/FbsFrpSqr5SKuunjmlLqeXMG5+zeew/uOvo1XVM2oaZOherVrR2SEMKGKK216W+ilCsQA7TUWp8r6LzQ0FAdGRlp8vWcwfnz0KR+Gr+5NKaGvyv8+it4eFg7LCGEFSilDmqtQ/MfN1cJpQvwe2HJWxRNztrfUYsb8WzaImpkn4H3t0ryFkLcwlwJ/EFglZney2nlrP0dd6ISPqeyeMnlTbbXb81133vpb+3ghBA2x+RRKEopD6AvsKaA749SSkUqpSJjY2NNvZxDm7H1JNevuXBl27286/E8bi6ZhHV8XNY4EUIYZY5hhPcDv2itLxn7ptZ6vtY6VGsd6uvra4bLOa6YuFRiI5rR5vrPPJi+lnktBhHtU03WOBFCGGWOEspQpHxiMq0h9fsgXP7y4pNyo4hWvnzcahAga5wIIYwzqQWulCoNdAPWmycc5/XBB3Bpfw2WVx5Cg8Tfebn7GFLdPWWNEyFEgUxqgWutk4FKZorFaW3dCuPGwfKGbzHw+CY+6vkEu+uG4idrnAghCiEzMa3sxAkYMgSeqbmRh46/DA89xOhl8xktGxULIW5D1kKxokOHoGdPCHY9wqzLD0Hz5rBggewyL4QoEkngVrJwIbRuDd5psWz17ItLeW/YsAG8pMNSCFE0UkIxUc7MyaKuy52SAmPHwqJF8EC7v1mRMhD3Ixfh++/BT2rdQoiikwRugpyZkykZWcC/u8MDRpP477/Df/8LUVGweNi3jNj+MOraNVi+HFq0sGjsQgj7JyUUE8zYejI3eefIvzu81vDzz/Dww9CwIUSfzeT04Jd4dFUPVOXKcOCAIasLIcQdkgRugoJmSF6ITyE1FZYuNTSsW7WCL7+EKQ//xfm7O3L3F2/ByJGG5N24sYWjFkI4Cimh3IH89W6f0u5cTc4AIPOaJ2kXfEi/UAF9uSIV5kBqKoTUT2bLyE10vrQS9+VfQ6lSsGIFDBtm5bsRQtg7SeBFlFPvTk7PIivRk9Ony5F5yYe0S+VJ+9ubrOuegKayy2U61DnGfzpH0z1jM9V+Wo9adN2wGcMzz8CYMVCnjrVvRwjhACSBF9Hrq85xcW8AtY5co17iOapzjOpcwL/Uefw9YqhR5jw10y5QOjMFzmD4KF/eMEtn2DDo0AFcXa19G0IIByIJvBCJibBh6TVOfrSD/zv+DT3ZQk3O534/U7kQ616B6vUDwK8xBPwHateGWrUMH40aGUomQghRAiSBY3wsd6Uzrlx95DmGpq7HnUwSXcuwp2YIc+v359fq9bhcpiJXSntTo0IZ9k7ubO1bEEI4IadL4PmTdacGvqw7GJM7HDD6nxS2Dv6cN8+8SRmVzKXBz+L3dF92lq7F5K9O5Bk2WNBKgXc6uUcIIYrDqRK4sYk3K/b9Rc62zpXOJ/P6uk/plbaN/WVDCdyzHP9gQ4LuB2h399sm5jud3COEEMXlVAnc2MSbnOTdZcdR3o2cjgfpvBw4jlU9O/J7cN7Wdf8Qv9sm4cIm90gCF0KYk1Ml8IIm3jTf9zvzIl8i0iOECQ+MJdq/Mn7F3AWnsMk9QghhTk41E9PY1mS1z8SyYPdUjrs2YOTjLxLtX9mkXXAK2v5MtkUTQpibUyXwiT3q4+X+71jsCnHXWbwhjFTlxeQnXyPFuxR+Pl5MHxgIQNvwnQRM3kzb8J1EHIop1jWg8M7O4lxDCCHAyUooOTXoGVtP8s/fCcxfNoOq2Zc5s/B7No8MzT3PlI7Im68hnZ1CiJKktNa3P8tMQkNDdWRkpMWuVxCdlc2Bux8k9Oxa9o5bR7tZA/J8v234TmKM1Kz9fLzMNubbEtcQQjgGpdRBrXVo/uOm7krvo5Raq5Q6oZQ6rpRqbcr7WcpPvd+gxdk1bO/2zi3JGyzTESmdnUIIU5laA58DbNFaNwCCgOOmh1SyYnadJnTrG+z2H0a3LeONnmOJjkjp7BRCmKrYCVwp5Q20BxYCaK3Ttdbx5gqspFwYNoE0SnF3xLsoF+ObB99JR2RxWeIaQgjHZkoLvA4QCyxWSh1SSn2qlCpjprhKxKF3vqX5xS/Z3+1l/JpVK/C8/iF+TB8YiJ+PFwpyR6aYs3PREtcQQji2YndiKqVCgX1AW631z0qpOcA1rfUr+c4bBYwCqFmzZrNz586ZGHLxZKRkcrZCMB5ZKVT95xie5WWVQCGEfSiJTsxoIFpr/fONr9cCTfOfpLWer7UO1VqH+vr6mnA50+x9ZB710n7j0oSZVkneMuZbCGFuxU7gWuu/gfNKqZyibRfgmFmiMrPYk1dosm4qhyp2pvmb/S1+/Zwx3zHxKWj+HfMtSVwIYQpTR6E8A6xQSv0KBANvmR6S+f06MIzyOh6fxe8V2HFZkoqye70QQtwpk2Ziaq2jgFvqMrYi4lAMn72zhy+OfcTy6sMof1dFAqwQh4z5FkKUBIedSp9Ttnhn42ckUo5Zff9DupWmqtfw8TI661LGfAshTOGwi1nN2HoSn9+u0jtlCwtqDSXBp4zVyhYy5lsIURIctgV+IT6FSbu2kYkbq7u3y3Pc0oq6wJUQQtwJh03gNVPcGH51DWsr9SGuonfucWuVLYqym48QQtwJhy2hjNgTSVmSWNK5R+4xKVsIIRyJQybwq7GZdI2az6GK7UlqWk+mqgshHJJDllB2PbueAfovsqZ+wN7nZG1tIYRjsssEHnEopsAOwbQ0uGvdbC541SXgmT5WjlQIIUqO3ZVQbjctfdtr+wjN2EfiyOfAxe5uTwghiszuMlxh09Kzs8H1w/dIdCnPPdMfs1KEQghhGXaXwAublr5zyV90v7aW8z2fRJUra+HIhBDCsuwugRe2Fdk/r38EQL33n7FkSEIIYRV2l8ALmpb+aKN76Hh2CWfq98G9bk0rRSeEEJZjd6NQCpqWnjTzMNW4hOv4R60boBBCWEixt1QrjtDQUB0ZGWn2983Kgq+9h9A+Ywflr18ADw+zX0MIIaylJLZUsxm7I67SLXkjGwN6EDD1W9myTAjhFBwigR98ZTmepLG6RUvZskwI4TTsPoHHxUHb46s45nkPv9Wok3tctiwTQjg6u0/gm2adog0/sS6wM6i8+13KlmVCCEdm1wlca0hb8BlZuPBliza3fF+2LBNCODK7TuCR+7PpEbuME3U6cb2Cb57vydrfQghHZ1ICV0qdVUodUUpFKaXMPz7wNn54Yxe1+IuAl55g+sBA/Hy8ZO1vIYTTMMdEnk5a63/M8D53JCkJqm5ZSpJ7ecoM7Ud/Ly9J2EIIp2K3JZSI5dfpm7mOaz0Gg5fUuoUQzsfUBK6BbUqpg0qpUcZOUEqNUkpFKqUiY2NjTbzcv86/t46yJFHtfyPM9p5CCGFPTE3gbbXWTYH7gTFKqfb5T9Baz9dah2qtQ319fW99h2KIiYFmJ5ZzpUJdVNtbR58IIYQzMCmBa60v3PjzMrABaGGOoG5n44LLdGYnDBlyy9hvIYRwFsVO4EqpMkqpcjmfA92Bo+YKrDDxC9fhSjYVnx5iicsJIYRNMmUUSlVggzK0gN2AlVrrLWaJqhDHjkGb6NVcqdKAioGBJX05IYSwWcVO4FrrP4AgM8ZSJF/Nu8BEvid5+FQpnwghnJpdDSPUGlKXr8UFTdnHpXwihHBuNr8jT8ShmNzdd8omVOWTK6u56h9IhYYNrR2aEEJYlU23wCMOxfDi+iPExKeggYw96bTlR/66/35rhyaEEFZn0wl8xtaTpGRkAaCzFH1O7gHgTe/G1gxLCCFsgk0n8JvX804568vgzHUc9mnAAbeKVoxKCCFsg00n8JvX8/Y9lEELDrC5SWtZ51sIIbDxBD6xR3283F3JTnel75+7ANjRpIOs8y2EENj4KJSc5WEnhcczOPtFDldpzDMju8qysUIIgY0ncDAk8UMuSYQQRfb/ZhEkyVsIIQAbL6HkeLXRagBcBj9g5UiEEMJ22EUCx88PRo4Ef39rRyKEEDbD5ksogCF5jxxp7SiEEMKm2EcLXAghxC0kgQshhJ2SBC6EEHZKErgQQtgpSeBCCGGnJIELIYSdkgQuhBB2ShK4EELYKaW1ttzFlIoFzhXz5ZWBf8wYjj2Qe3YOcs/OwZR7rqW19s1/0KIJ3BRKqUitdai147AkuWfnIPfsHErinqWEIoQQdkoSuBBC2Cl7SuDzrR2AFcg9Owe5Z+dg9nu2mxq4EEKIvOypBS6EEOImksCFEMJO2UUCV0r1VEqdVEqdUUpNtnY8lqCUOquUOqKUilJKRVo7npKglFqklLqslDp607GKSqlvlVKnb/xZwZoxmlsB9xymlIq58ayjlFK9rBmjOSml7lJKfaeUOq6U+k0p9dyN4w77nAu5Z7M/Z5uvgSulXIFTQDcgGjgADNVaH7NqYCVMKXUWCNVaO+xkB6VUe+A68JnWuvGNY+8AV7TW4Tf+s66gtf6fNeM0pwLuOQy4rrWeac3YSoJSqjpQXWv9i1KqHHAQ6A88ioM+50LueTBmfs720AJvAZzRWv+htU4HPgf6WTkmYQZa6++BK/kO9wOW3vh8KYYffIdRwD07LK31Ra31Lzc+TwSOA3448HMu5J7Nzh4SuB9w/qavoymhvwwbo4FtSqmDSqlR1g7GgqpqrS+C4R8CUMXK8VjKWKXUrzdKLA5TTriZUqo2EAL8jJM853z3DGZ+zvaQwJWRY7Zd9zGPtlrrpsD9wJgbv3oLx/QxUBcIBi4C71o3HPNTSpUF1gHPa62vWTseSzByz2Z/zvaQwKOBu2762h+4YKVYLEZrfeHGn5eBDRhKSc7g0o0aYk4t8bKV4ylxWutLWussrXU2sAAHe9ZKKXcMiWyF1nr9jcMO/ZyN3XNJPGd7SOAHgHpKqQCllAfwIPCllWMqUUqpMjc6P1BKlQG6A0cLf5XD+BIYcePzEcBGK8ZiETmJ7IYBONCzVkopYCFwXGs966ZvOexzLuieS+I52/woFIAbw23eA1yBRVrrN60cUolSStXB0OoGcANWOuI9K6VWAR0xLLN5CZgGRABfADWBv4AHtNYO0+lXwD13xPBrtQbOAv+XUx+2d0qp+4A9wBEg+8bhKRhqwg75nAu556GY+TnbRQIXQghxK3sooQghhDBCErgQQtgpSeBCCGGnJIELIYSdkgQuhBB2ShK4EELYKUngQghhp/4fDXi4CBf2cG4AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           4.942454\n",
       "x1                  0.506652\n",
       "np.sin(x1)          0.548737\n",
       "I((x1 - 5) ** 2)   -0.019971\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    11.077857\n",
       "1    10.928751\n",
       "2    10.657255\n",
       "3    10.312409\n",
       "4     9.958767\n",
       "5     9.660592\n",
       "6     9.466120\n",
       "7     9.395756\n",
       "8     9.437070\n",
       "9     9.547848\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
