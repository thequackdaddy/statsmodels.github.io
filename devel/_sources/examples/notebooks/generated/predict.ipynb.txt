{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.983\n",
      "Model:                            OLS   Adj. R-squared:                  0.982\n",
      "Method:                 Least Squares   F-statistic:                     889.3\n",
      "Date:                Tue, 17 Dec 2019   Prob (F-statistic):           1.02e-40\n",
      "Time:                        00:24:50   Log-Likelihood:                 1.0064\n",
      "No. Observations:                  50   AIC:                             5.987\n",
      "Df Residuals:                      46   BIC:                             13.64\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.1304      0.084     60.879      0.000       4.961       5.300\n",
      "x1             0.4858      0.013     37.381      0.000       0.460       0.512\n",
      "x2             0.5155      0.051     10.090      0.000       0.413       0.618\n",
      "x3            -0.0191      0.001    -16.759      0.000      -0.021      -0.017\n",
      "==============================================================================\n",
      "Omnibus:                        1.621   Durbin-Watson:                   2.175\n",
      "Prob(Omnibus):                  0.445   Jarque-Bera (JB):                1.233\n",
      "Skew:                           0.152   Prob(JB):                        0.540\n",
      "Kurtosis:                       2.293   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.65229029  5.13008498  5.56788809  5.9376037   6.22127558  6.41403731\n",
      "  6.52491183  6.57532901  6.59560479  6.6199603   6.6808995   6.80386883\n",
      "  7.00307642  7.27915779  7.61907136  7.9982412   8.38459479  8.74383239\n",
      "  9.04506245  9.26587696  9.39603305  9.43913586  9.41204622  9.34211046\n",
      "  9.26266748  9.2075713   9.20562889  9.2758673   9.42440757  9.64345901\n",
      "  9.91259928 10.20212964 10.47795441 10.70718277 10.86353266 10.93164882\n",
      " 10.90962563 10.80932019 10.65440424 10.47647496 10.30986362 10.1859951\n",
      " 10.1282248  10.1480015  10.24298626 10.39743679 10.58479382 10.77204471\n",
      " 10.92514734 11.01462315]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[11.00913681 10.86826887 10.61223646 10.28711184  9.9535423   9.67190164\n",
      "  9.48750848  9.41953075  9.45629266  9.55813338]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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SgBrgRMpX4vf7zw6nybwdevW6ebNm6fbduPGDV2iRAl9584dk4kwOjpa+/j46Jj7rCQeEhKiX3zxRR0UFKQffvhhPXv2bK21Mbm2atVK9+7dW9eoUUNrrfWiRYt0gwYNdL169fSgQYPSEvu3336rq1Wrplu0aKFffvnltAQeEhKip0yZorXW+sSJE7pNmza6bt26OiAgQJ88eVI3atRIFy1aVNerV09Pnz493X1ER0frrl276jp16uhGjRrpAwcOpJ2zf//+umXLlrpy5cr6008/NXlftn7NLG3Xm0u1Br3umVm2DsUq/t14Vq95crr+o9VEvbrvd3rjB1v07uVn9al/EnVysq2js7IxY4xpbssWW0dilqwSeE5q4POBL4B7P68HA+u11qFKqeCUn982++OADeaTPXLkCI899li6bUWLFqVChQqcPHnS5DElSpSgS5cuVKxYkTZt2tC5c2d69+5tcsGHgwcPsmPHDu7cuUNAQACdOhlHuu3atYvDhw9TuXJljh49ytKlS9m2bRuurq4MGTKE7777jnbt2hESEsKePXsoVqwYQUFBBAQEZLrGCy+8QHBwMN27dycuLg6DwUBoaChTp05l1apVgLEUlCokJISAgADCwsLYsGEDL730EvtT/t6PHTvGxo0buXXrFtWrV+e1117D1dU1+79jOxYbHYPvjDc56uFPy0Uv2zocq6jSqgJVWo2ydRi2ERJinCNl8GDYtw8c7N/yfWvgWuvNwNUMm7sCC1K+XwB0s3BceUZrjTIxg1lW21PNmTOH9evX07BhQ6ZOncqAAQNM7te1a1c8PT0pVaoUQUFB7Nq1C4CGDRtSubJxfuf169ezZ88eGjRogL+/P+vXr+fUqVPs3LmTVq1a4ePjg5ubG88++2ym89+6dYvIyEi6d+8OgIeHB4UKFcr2nrdu3UqfPn0AaN26NdHR0dy4cQOATp064e7uTqlSpShdujSXLl3K7lR2b2fPyfglnydu0me4uDvf/wBhX7y8jPOFHzkC06fbOhqLy20vlDJa6/8AtNb/KaVKWyQaG8wnW6tWLZYvX55u282bNzl//jxVq1YlOpsHIHXq1KFOnTr06dOHypUrM3/+/Ez7ZHwTSP353qlqtdb07duXiRMnpts3LCws2zeR1GMflKljUq/jnjrcDnB2ds52IQt7d37rWRr9OYm/yj9L0+HN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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.130396\n",
       "x1                  0.485826\n",
       "np.sin(x1)          0.515530\n",
       "I((x1 - 5) ** 2)   -0.019124\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    11.009137\n",
       "1    10.868269\n",
       "2    10.612236\n",
       "3    10.287112\n",
       "4     9.953542\n",
       "5     9.671902\n",
       "6     9.487508\n",
       "7     9.419531\n",
       "8     9.456293\n",
       "9     9.558133\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
