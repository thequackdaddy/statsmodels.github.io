{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.984\n",
      "Model:                            OLS   Adj. R-squared:                  0.983\n",
      "Method:                 Least Squares   F-statistic:                     955.0\n",
      "Date:                Thu, 05 Dec 2019   Prob (F-statistic):           2.03e-41\n",
      "Time:                        18:32:50   Log-Likelihood:                0.94493\n",
      "No. Observations:                  50   AIC:                             6.110\n",
      "Df Residuals:                      46   BIC:                             13.76\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          4.8399      0.084     57.362      0.000       4.670       5.010\n",
      "x1             0.5226      0.013     40.164      0.000       0.496       0.549\n",
      "x2             0.5016      0.051      9.806      0.000       0.399       0.605\n",
      "x3            -0.0221      0.001    -19.342      0.000      -0.024      -0.020\n",
      "==============================================================================\n",
      "Omnibus:                        2.352   Durbin-Watson:                   2.353\n",
      "Prob(Omnibus):                  0.309   Jarque-Bera (JB):                2.042\n",
      "Skew:                          -0.379   Prob(JB):                        0.360\n",
      "Kurtosis:                       2.364   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.2874223   4.78637484  5.24525099  5.63671234  5.94328675  6.16023901\n",
      "  6.2963488   6.37246823  6.41809588  6.46653029  6.54939907  6.69146261\n",
      "  6.90654601  7.19526761  7.54493747  7.93164224  8.32417408  8.68915801\n",
      "  8.99653531  9.22450213  9.36309175  9.4158121   9.39906944  9.33947281\n",
      "  9.2694623   9.22197919  9.2250538   9.2972002   9.44437439  9.65899575\n",
      "  9.92119251 10.20206664 10.4684417  10.68831362 10.83610893 10.89688635\n",
      " 10.86879164 10.76336222 10.60363163 10.42034517 10.24690853 10.11389932\n",
      " 10.04404331 10.04848058 10.12493527 10.25808951 10.42210007 10.58484435\n",
      " 10.71319805 10.77847734]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.74486834 10.5777825  10.29689187  9.94702657  9.58719884  9.27615472\n",
      "  9.05799104  8.95135893  8.94489741  9.00001492]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           4.839899\n",
       "x1                  0.522645\n",
       "np.sin(x1)          0.501631\n",
       "I((x1 - 5) ** 2)   -0.022099\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.744868\n",
       "1    10.577783\n",
       "2    10.296892\n",
       "3     9.947027\n",
       "4     9.587199\n",
       "5     9.276155\n",
       "6     9.057991\n",
       "7     8.951359\n",
       "8     8.944897\n",
       "9     9.000015\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
