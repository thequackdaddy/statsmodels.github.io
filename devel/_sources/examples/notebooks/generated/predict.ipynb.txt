{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.984\n",
      "Model:                            OLS   Adj. R-squared:                  0.983\n",
      "Method:                 Least Squares   F-statistic:                     957.7\n",
      "Date:                Fri, 06 Dec 2019   Prob (F-statistic):           1.90e-41\n",
      "Time:                        00:32:07   Log-Likelihood:                 2.9400\n",
      "No. Observations:                  50   AIC:                             2.120\n",
      "Df Residuals:                      46   BIC:                             9.768\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          5.0463      0.081     62.242      0.000       4.883       5.209\n",
      "x1             0.4860      0.013     38.872      0.000       0.461       0.511\n",
      "x2             0.4996      0.049     10.163      0.000       0.401       0.598\n",
      "x3            -0.0192      0.001    -17.497      0.000      -0.021      -0.017\n",
      "==============================================================================\n",
      "Omnibus:                        0.198   Durbin-Watson:                   2.221\n",
      "Prob(Omnibus):                  0.906   Jarque-Bera (JB):                0.313\n",
      "Skew:                           0.136   Prob(JB):                        0.855\n",
      "Kurtosis:                       2.725   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.56602222  5.03789727  5.47079409  5.83748735  6.12057719  6.31534799\n",
      "  6.43054311  6.4869284   6.51388042  6.54455996  6.61046381  6.73624994\n",
      "  6.93568622  7.20938848  7.54471926  7.91786412  8.29774432  8.65112293\n",
      "  8.9480656   9.16685865  9.29757659  9.34371285  9.32160581  9.25775445\n",
      "  9.18446467  9.13454147  9.13589923  9.20697543  9.35370143  9.56852797\n",
      "  9.83166549 10.11433549 10.38349877 10.60728366 10.76022246 10.82743571\n",
      " 10.80707684 10.71063554 10.56105006 10.38893853 10.22756845 10.10739095\n",
      " 10.05103777 10.06960293 10.16081998 10.3094344  10.48970987 10.66965669\n",
      " 10.81628755 10.90103731]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.8930201  10.75347733 10.50199968 10.18323184  9.85594192  9.57863296\n",
      "  9.39521937  9.32427513  9.35448627  9.44742084]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           5.046256\n",
       "x1                  0.486041\n",
       "np.sin(x1)          0.499556\n",
       "I((x1 - 5) ** 2)   -0.019209\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.893020\n",
       "1    10.753477\n",
       "2    10.502000\n",
       "3    10.183232\n",
       "4     9.855942\n",
       "5     9.578633\n",
       "6     9.395219\n",
       "7     9.324275\n",
       "8     9.354486\n",
       "9     9.447421\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
