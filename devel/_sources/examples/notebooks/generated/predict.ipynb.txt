{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Prediction (out of sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Artificial data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "nsample = 50\n",
    "sig = 0.25\n",
    "x1 = np.linspace(0, 20, nsample)\n",
    "X = np.column_stack((x1, np.sin(x1), (x1-5)**2))\n",
    "X = sm.add_constant(X)\n",
    "beta = [5., 0.5, 0.5, -0.02]\n",
    "y_true = np.dot(X, beta)\n",
    "y = y_true + sig * np.random.normal(size=nsample)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Estimation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            OLS Regression Results                            \n",
      "==============================================================================\n",
      "Dep. Variable:                      y   R-squared:                       0.984\n",
      "Model:                            OLS   Adj. R-squared:                  0.983\n",
      "Method:                 Least Squares   F-statistic:                     932.7\n",
      "Date:                Mon, 16 Dec 2019   Prob (F-statistic):           3.47e-41\n",
      "Time:                        16:13:12   Log-Likelihood:                0.44717\n",
      "No. Observations:                  50   AIC:                             7.106\n",
      "Df Residuals:                      46   BIC:                             14.75\n",
      "Df Model:                           3                                         \n",
      "Covariance Type:            nonrobust                                         \n",
      "==============================================================================\n",
      "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
      "------------------------------------------------------------------------------\n",
      "const          4.9779      0.085     58.413      0.000       4.806       5.149\n",
      "x1             0.5073      0.013     38.600      0.000       0.481       0.534\n",
      "x2             0.4164      0.052      8.059      0.000       0.312       0.520\n",
      "x3            -0.0203      0.001    -17.601      0.000      -0.023      -0.018\n",
      "==============================================================================\n",
      "Omnibus:                        0.746   Durbin-Watson:                   2.430\n",
      "Prob(Omnibus):                  0.689   Jarque-Bera (JB):                0.720\n",
      "Skew:                           0.272   Prob(JB):                        0.698\n",
      "Kurtosis:                       2.775   Cond. No.                         221.\n",
      "==============================================================================\n",
      "\n",
      "Warnings:\n",
      "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n"
     ]
    }
   ],
   "source": [
    "olsmod = sm.OLS(y, X)\n",
    "olsres = olsmod.fit()\n",
    "print(olsres.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## In-sample prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 4.47013395  4.92199236  5.33992941  5.70125255  5.99145883  6.20661772\n",
      "  6.35401691  6.45096493  6.5219474   6.59460416  6.69518806  6.84425173\n",
      "  7.05327086  7.32275872  7.64218187  7.99169077  8.34538099  8.67554925\n",
      "  8.95724499  9.17236966  9.31265028  9.38099864  9.39103294  9.36484032\n",
      "  9.32934805  9.3118994   9.33576126  9.41630143  9.55846377  9.7559559\n",
      "  9.99228303 10.24345802 10.48194239 10.68117082 10.81991573 10.88577496\n",
      " 10.87720938 10.80379575 10.68465333 10.54530258 10.41347229 10.31454376\n",
      " 10.26738074 10.2812302  10.35420304 10.47358448 10.61792305 10.76055504\n",
      " 10.87398524 10.93440432]\n"
     ]
    }
   ],
   "source": [
    "ypred = olsres.predict(X)\n",
    "print(ypred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create a new sample of explanatory variables Xnew, predict and plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[10.91324921 10.78031649 10.55193515 10.26531696  9.96944567  9.71308412\n",
      "  9.53283536  9.444181    9.4376907   9.48133111]\n"
     ]
    }
   ],
   "source": [
    "x1n = np.linspace(20.5,25, 10)\n",
    "Xnew = np.column_stack((x1n, np.sin(x1n), (x1n-5)**2))\n",
    "Xnew = sm.add_constant(Xnew)\n",
    "ynewpred =  olsres.predict(Xnew) # predict out of sample\n",
    "print(ynewpred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plot comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(x1, y, 'o', label=\"Data\")\n",
    "ax.plot(x1, y_true, 'b-', label=\"True\")\n",
    "ax.plot(np.hstack((x1, x1n)), np.hstack((ypred, ynewpred)), 'r', label=\"OLS prediction\")\n",
    "ax.legend(loc=\"best\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Predicting with Formulas"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using formulas can make both estimation and prediction a lot easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from statsmodels.formula.api import ols\n",
    "\n",
    "data = {\"x1\" : x1, \"y\" : y}\n",
    "\n",
    "res = ols(\"y ~ x1 + np.sin(x1) + I((x1-5)**2)\", data=data).fit()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use the `I` to indicate use of the Identity transform. Ie., we do not want any expansion magic from using `**2`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Intercept           4.977906\n",
       "x1                  0.507316\n",
       "np.sin(x1)          0.416384\n",
       "I((x1 - 5) ** 2)   -0.020311\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we only have to pass the single variable and we get the transformed right-hand side variables automatically"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    10.913249\n",
       "1    10.780316\n",
       "2    10.551935\n",
       "3    10.265317\n",
       "4     9.969446\n",
       "5     9.713084\n",
       "6     9.532835\n",
       "7     9.444181\n",
       "8     9.437691\n",
       "9     9.481331\n",
       "dtype: float64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res.predict(exog=dict(x1=x1n))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
